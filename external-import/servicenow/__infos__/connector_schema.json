{
  "$defs": {
    "_ConfigLoaderConnector": {
      "additionalProperties": true,
      "description": "Interface for loading Connector dedicated configuration.",
      "properties": {
        "id": {
          "description": "A unique UUIDv4 identifier for this connector instance.",
          "title": "Id",
          "type": "string"
        },
        "type": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": "EXTERNAL_IMPORT",
          "description": "Should always be set to EXTERNAL_IMPORT for this connector.",
          "title": "Type"
        },
        "name": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": "ServiceNow",
          "description": "Name of the connector.",
          "title": "Name"
        },
        "scope": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": "ServiceNow",
          "description": "The scope or type of data the connector is importing, either a MIME type or Stix Object (for information only).",
          "title": "Scope"
        },
        "log_level": {
          "anyOf": [
            {},
            {
              "type": "null"
            }
          ],
          "default": "error",
          "description": "Determines the verbosity of the logs.",
          "title": "Log Level"
        },
        "duration_period": {
          "anyOf": [
            {
              "format": "duration",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": "PT24H",
          "description": "Duration between two scheduled runs of the connector (ISO 8601 format).",
          "title": "Duration Period"
        },
        "queue_threshold": {
          "anyOf": [
            {
              "exclusiveMinimum": 0,
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Connector queue max size in Mbytes. Default to 500.",
          "title": "Queue Threshold"
        },
        "run_and_terminate": {
          "anyOf": [
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Connector run-and-terminate flag.",
          "title": "Run And Terminate"
        },
        "send_to_queue": {
          "anyOf": [
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Connector send-to-queue flag.",
          "title": "Send To Queue"
        },
        "send_to_directory": {
          "anyOf": [
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Connector send-to-directory flag.",
          "title": "Send To Directory"
        },
        "send_to_directory_path": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Connector send-to-directory path.",
          "title": "Send To Directory Path"
        },
        "send_to_directory_retention": {
          "anyOf": [
            {
              "exclusiveMinimum": 0,
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "Connector send-to-directory retention in days.",
          "title": "Send To Directory Retention"
        }
      },
      "required": [
        "id"
      ],
      "title": "_ConfigLoaderConnector",
      "type": "object"
    },
    "_ConfigLoaderOCTI": {
      "additionalProperties": true,
      "description": "Interface for loading OpenCTI dedicated configuration.",
      "properties": {
        "url": {
          "description": "The OpenCTI platform URL.",
          "format": "uri",
          "maxLength": 2083,
          "minLength": 1,
          "title": "Url",
          "type": "string"
        },
        "token": {
          "description": "The token of the user who represents the connector in the OpenCTI platform.",
          "title": "Token",
          "type": "string"
        }
      },
      "required": [
        "url",
        "token"
      ],
      "title": "_ConfigLoaderOCTI",
      "type": "object"
    },
    "_ConfigLoaderServiceNow": {
      "additionalProperties": true,
      "description": "Interface for loading ServiceNow dedicated configuration.",
      "properties": {
        "instance_name": {
          "description": "Corresponds to server instance name (will be used for API requests).",
          "title": "Instance Name",
          "type": "string"
        },
        "api_key": {
          "description": "Secure identifier used to validate access to ServiceNow APIs.",
          "title": "Api Key",
          "type": "string"
        },
        "api_version": {
          "anyOf": [
            {
              "enum": [
                "v1",
                "v2"
              ],
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": "v2",
          "description": "ServiceNow API version used for REST requests.",
          "title": "Api Version"
        },
        "api_leaky_bucket_rate": {
          "anyOf": [
            {
              "exclusiveMinimum": 0,
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": 10,
          "description": "Bucket refill rate (in tokens per second). Controls the rate at which API calls are allowed. For example, a rate of 10 means that 10 calls can be made per second, if the bucket is not empty.",
          "title": "Api Leaky Bucket Rate"
        },
        "api_leaky_bucket_capacity": {
          "anyOf": [
            {
              "exclusiveMinimum": 0,
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": 10,
          "description": "Maximum bucket capacity (in tokens). Defines the number of calls that can be made immediately in a burst. Once the bucket is empty, it refills at the rate defined by 'api_leaky_bucket_rate'.",
          "title": "Api Leaky Bucket Capacity"
        },
        "api_retry": {
          "anyOf": [
            {
              "exclusiveMinimum": 0,
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": 5,
          "description": "Maximum number of retry attempts in case of API failure.",
          "title": "Api Retry"
        },
        "api_backoff": {
          "anyOf": [
            {
              "format": "duration",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": "PT30S",
          "description": "Exponential backoff duration between API retries (ISO 8601 duration format).",
          "title": "Api Backoff"
        },
        "import_start_date": {
          "anyOf": [
            {
              "format": "date",
              "type": "string"
            },
            {
              "format": "date-time",
              "type": "string"
            },
            {
              "format": "duration",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": "P30D",
          "description": "Start date of first import (ISO date format).",
          "title": "Import Start Date"
        },
        "state_to_exclude": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "List of security incident states to exclude from import.",
          "title": "State To Exclude"
        },
        "severity_to_exclude": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "List of security incident severities to exclude from import.",
          "title": "Severity To Exclude"
        },
        "priority_to_exclude": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "List of security incident priorities to exclude from import.",
          "title": "Priority To Exclude"
        },
        "comment_to_exclude": {
          "anyOf": [
            {
              "items": {
                "enum": [
                  "private",
                  "public",
                  "auto"
                ],
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "description": "List of comment types to exclude: private, public, auto",
          "title": "Comment To Exclude"
        },
        "tlp_level": {
          "anyOf": [
            {},
            {
              "type": "null"
            }
          ],
          "default": "red",
          "description": "Traffic Light Protocol (TLP) level to apply on objects imported into OpenCTI.",
          "title": "Tlp Level"
        },
        "observables_default_score": {
          "anyOf": [
            {
              "exclusiveMinimum": 0,
              "type": "integer"
            },
            {
              "type": "null"
            }
          ],
          "default": 50,
          "description": "Allows you to define a default score for observables and indicators when the \u2018promote_observables_as_indicators\u2019 variable is set to True.",
          "title": "Observables Default Score"
        },
        "promote_observables_as_indicators": {
          "anyOf": [
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ],
          "default": true,
          "description": "Boolean to promote observables into indicators.",
          "title": "Promote Observables As Indicators"
        }
      },
      "required": [
        "instance_name",
        "api_key"
      ],
      "title": "_ConfigLoaderServiceNow",
      "type": "object"
    }
  },
  "additionalProperties": true,
  "description": "Accurate IP address data that keeps pace with secure, specific, and forward-looking use cases",
  "properties": {
    "opencti": {
      "$ref": "#/$defs/_ConfigLoaderOCTI",
      "description": "OpenCTI configurations."
    },
    "connector": {
      "$ref": "#/$defs/_ConfigLoaderConnector",
      "description": "Connector configurations."
    },
    "servicenow": {
      "$ref": "#/$defs/_ConfigLoaderServiceNow",
      "description": "ServiceNow configurations."
    }
  },
  "title": "IpInfo connector",
  "type": "object",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://www.filigran.io/ipinfo.schema.json",
  "short_description": "",
  "manager_supported": true,
  "container_version": "[VARIABLE]",
  "container_image": "opencti/connector-[VARIABLE]",
  "container_type": "[VARIABLE]",
  "verified": true,
  "last_verified_date": "15-06-2025",
  "playbook_supported": true,
  "images": "[VARIABLE]",
  "trial_link": null,
  "subscription_link": "https://ipinfo.io/contact",
  "source_code": "https://github.com/OpenCTI-Platform/connectors/tree/master/internal-enrichment/ipinfo"
}
