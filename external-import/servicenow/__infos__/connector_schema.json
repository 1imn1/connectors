{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://www.filigran.io/servicenow.schema.json",
  "title": "ServiceNow connector",
  "description": "Accurate IP address data that keeps pace with secure, specific, and forward-looking use cases",
  "short_description": "",
  "manager_supported": true,
  "container_version": "[VARIABLE]",
  "container_image": "opencti/connector-servicenow:6.7.0",
  "container_type": "[VARIABLE]",
  "verified": true,
  "last_verified_date": "15-06-2025",
  "playbook_supported": true,
  "images": "[VARIABLE]",
  "support_version": ">= 6.5.1",
  "trial_link": null,
  "subscription_link": "https://www.servicenow.com/contact-us.html",
  "source_code": "https://github.com/OpenCTI-Platform/connectors/tree/master/external-import/servicenow",
  "type": "object",
  "additionalProperties": true,
  "default": {
    "CONNECTOR_TYPE": "EXTERNAL_IMPORT",
    "CONNECTOR_NAME": "ServiceNow",
    "CONNECTOR_SCOPE": "ServiceNow",
    "CONNECTOR_LOG_LEVEL": "error",
    "CONNECTOR_DURATION_PERIOD": "PT24H",
    "CONNECTOR_QUEUE_THRESHOLD": null,
    "CONNECTOR_RUN_AND_TERMINATE": null,
    "CONNECTOR_SEND_TO_QUEUE": null,
    "CONNECTOR_SEND_TO_DIRECTORY": null,
    "CONNECTOR_SEND_TO_DIRECTORY_PATH": null,
    "CONNECTOR_SEND_TO_DIRECTORY_RETENTION": null,
    "SERVICENOW_API_VERSION": "v2",
    "SERVICENOW_API_LEAKY_BUCKET_RATE": 10,
    "SERVICENOW_API_LEAKY_BUCKET_CAPACITY": 10,
    "SERVICENOW_API_RETRY": 5,
    "SERVICENOW_API_BACKOFF": "PT30S",
    "SERVICENOW_IMPORT_START_DATE": "P30D",
    "SERVICENOW_STATE_TO_EXCLUDE": null,
    "SERVICENOW_SEVERITY_TO_EXCLUDE": null,
    "SERVICENOW_PRIORITY_TO_EXCLUDE": null,
    "SERVICENOW_COMMENT_TO_EXCLUDE": null,
    "SERVICENOW_TLP_LEVEL": "red",
    "SERVICENOW_OBSERVABLES_DEFAULT_SCORE": 50,
    "SERVICENOW_PROMOTE_OBSERVABLES_AS_INDICATORS": true
  },
  "required": [
    "OPENCTI_URL",
    "OPENCTI_TOKEN",
    "CONNECTOR_ID",
    "SERVICENOW_INSTANCE_NAME",
    "SERVICENOW_API_KEY"
  ],
  "properties": {
    "OPENCTI_URL": {
      "type": "string",
      "format": "uri",
      "minLength": 1,
      "maxLength": 2083,
      "description": "The OpenCTI platform URL.",
      "title": "Opencti Url"
    },
    "OPENCTI_TOKEN": {
      "type": "string",
      "description": "The token of the user who represents the connector in the OpenCTI platform.",
      "title": "Opencti Token"
    },
    "CONNECTOR_ID": {
      "type": "string",
      "description": "A unique UUIDv4 identifier for this connector instance.",
      "title": "Connector Id"
    },
    "CONNECTOR_TYPE": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "description": "Should always be set to EXTERNAL_IMPORT for this connector.",
      "title": "Connector Type"
    },
    "CONNECTOR_NAME": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "description": "Name of the connector.",
      "title": "Connector Name"
    },
    "CONNECTOR_SCOPE": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "description": "The scope or type of data the connector is importing, either a MIME type or Stix Object (for information only).",
      "title": "Connector Scope"
    },
    "CONNECTOR_LOG_LEVEL": {
      "anyOf": [
        {
          "enum": [
            "debug",
            "info",
            "warn",
            "error"
          ],
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "description": "Determines the verbosity of the logs.",
      "title": "Connector Log Level"
    },
    "CONNECTOR_DURATION_PERIOD": {
      "anyOf": [
        {
          "type": "string",
          "format": "duration"
        },
        {
          "type": "null"
        }
      ],
      "description": "Duration between two scheduled runs of the connector (ISO 8601 format).",
      "title": "Connector Duration Period"
    },
    "CONNECTOR_QUEUE_THRESHOLD": {
      "anyOf": [
        {
          "type": "integer",
          "exclusiveMinimum": 0
        },
        {
          "type": "null"
        }
      ],
      "description": "Connector queue max size in Mbytes. Default to 500.",
      "title": "Connector Queue Threshold"
    },
    "CONNECTOR_RUN_AND_TERMINATE": {
      "anyOf": [
        {
          "type": "boolean"
        },
        {
          "type": "null"
        }
      ],
      "description": "Connector run-and-terminate flag.",
      "title": "Connector Run And Terminate"
    },
    "CONNECTOR_SEND_TO_QUEUE": {
      "anyOf": [
        {
          "type": "boolean"
        },
        {
          "type": "null"
        }
      ],
      "description": "Connector send-to-queue flag.",
      "title": "Connector Send To Queue"
    },
    "CONNECTOR_SEND_TO_DIRECTORY": {
      "anyOf": [
        {
          "type": "boolean"
        },
        {
          "type": "null"
        }
      ],
      "description": "Connector send-to-directory flag.",
      "title": "Connector Send To Directory"
    },
    "CONNECTOR_SEND_TO_DIRECTORY_PATH": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "description": "Connector send-to-directory path.",
      "title": "Connector Send To Directory Path"
    },
    "CONNECTOR_SEND_TO_DIRECTORY_RETENTION": {
      "anyOf": [
        {
          "type": "integer",
          "exclusiveMinimum": 0
        },
        {
          "type": "null"
        }
      ],
      "description": "Connector send-to-directory retention in days.",
      "title": "Connector Send To Directory Retention"
    },
    "SERVICENOW_INSTANCE_NAME": {
      "type": "string",
      "description": "Corresponds to server instance name (will be used for API requests).",
      "title": "Servicenow Instance Name"
    },
    "SERVICENOW_API_KEY": {
      "type": "string",
      "description": "Secure identifier used to validate access to ServiceNow APIs.",
      "title": "Servicenow Api Key"
    },
    "SERVICENOW_API_VERSION": {
      "anyOf": [
        {
          "enum": [
            "v1",
            "v2"
          ],
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "description": "ServiceNow API version used for REST requests.",
      "title": "Servicenow Api Version"
    },
    "SERVICENOW_API_LEAKY_BUCKET_RATE": {
      "anyOf": [
        {
          "type": "integer",
          "exclusiveMinimum": 0
        },
        {
          "type": "null"
        }
      ],
      "description": "Bucket refill rate (in tokens per second). Controls the rate at which API calls are allowed. For example, a rate of 10 means that 10 calls can be made per second, if the bucket is not empty.",
      "title": "Servicenow Api Leaky Bucket Rate"
    },
    "SERVICENOW_API_LEAKY_BUCKET_CAPACITY": {
      "anyOf": [
        {
          "type": "integer",
          "exclusiveMinimum": 0
        },
        {
          "type": "null"
        }
      ],
      "description": "Maximum bucket capacity (in tokens). Defines the number of calls that can be made immediately in a burst. Once the bucket is empty, it refills at the rate defined by 'api_leaky_bucket_rate'.",
      "title": "Servicenow Api Leaky Bucket Capacity"
    },
    "SERVICENOW_API_RETRY": {
      "anyOf": [
        {
          "type": "integer",
          "exclusiveMinimum": 0
        },
        {
          "type": "null"
        }
      ],
      "description": "Maximum number of retry attempts in case of API failure.",
      "title": "Servicenow Api Retry"
    },
    "SERVICENOW_API_BACKOFF": {
      "anyOf": [
        {
          "type": "string",
          "format": "duration"
        },
        {
          "type": "null"
        }
      ],
      "description": "Exponential backoff duration between API retries (ISO 8601 duration format).",
      "title": "Servicenow Api Backoff"
    },
    "SERVICENOW_IMPORT_START_DATE": {
      "anyOf": [
        {
          "type": "string",
          "format": "date"
        },
        {
          "type": "string",
          "format": "date-time"
        },
        {
          "type": "string",
          "format": "duration"
        },
        {
          "type": "null"
        }
      ],
      "description": "Start date of first import (ISO date format).",
      "title": "Servicenow Import Start Date"
    },
    "SERVICENOW_STATE_TO_EXCLUDE": {
      "anyOf": [
        {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        {
          "type": "null"
        }
      ],
      "description": "List of security incident states to exclude from import.",
      "title": "Servicenow State To Exclude"
    },
    "SERVICENOW_SEVERITY_TO_EXCLUDE": {
      "anyOf": [
        {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        {
          "type": "null"
        }
      ],
      "description": "List of security incident severities to exclude from import.",
      "title": "Servicenow Severity To Exclude"
    },
    "SERVICENOW_PRIORITY_TO_EXCLUDE": {
      "anyOf": [
        {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        {
          "type": "null"
        }
      ],
      "description": "List of security incident priorities to exclude from import.",
      "title": "Servicenow Priority To Exclude"
    },
    "SERVICENOW_COMMENT_TO_EXCLUDE": {
      "anyOf": [
        {
          "type": "array",
          "items": {
            "enum": [
              "private",
              "public",
              "auto"
            ],
            "type": "string"
          }
        },
        {
          "type": "null"
        }
      ],
      "description": "List of comment types to exclude: private, public, auto",
      "title": "Servicenow Comment To Exclude"
    },
    "SERVICENOW_TLP_LEVEL": {
      "anyOf": [
        {
          "enum": [
            "clear",
            "green",
            "amber",
            "amber+strict",
            "red"
          ],
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "description": "Traffic Light Protocol (TLP) level to apply on objects imported into OpenCTI.",
      "title": "Servicenow Tlp Level"
    },
    "SERVICENOW_OBSERVABLES_DEFAULT_SCORE": {
      "anyOf": [
        {
          "type": "integer",
          "exclusiveMinimum": 0
        },
        {
          "type": "null"
        }
      ],
      "description": "Allows you to define a default score for observables and indicators when the 'promote_observables_as_indicators' variable is set to True.",
      "title": "Servicenow Observables Default Score"
    },
    "SERVICENOW_PROMOTE_OBSERVABLES_AS_INDICATORS": {
      "anyOf": [
        {
          "type": "boolean"
        },
        {
          "type": "null"
        }
      ],
      "description": "Boolean to promote observables into indicators.",
      "title": "Servicenow Promote Observables As Indicators"
    }
  }
}